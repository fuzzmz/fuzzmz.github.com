<!DOCTYPE html>
<html lang="en">
<head>
        <title>QWERTY - fast keystrokes</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
        
        

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->
<script type="text/javascript" src="./static/js/prototype.js"></script>
<script type="text/javascript" src="./static/js/scriptaculous.js?load=effects,builder"></script>
<script type="text/javascript" src="./static/js/lightbox.js"></script>
<link rel="stylesheet" href="./static/js/lightbox.css" type="text/css" media="screen" />
</head>

<body id="index" class="home">

        <header id="banner" class="body">
                <h1><a href=".">QWERTY - fast keystrokes </a></h1>
                <nav><ul>
                
                
                
                
                
                    <li ><a href="./category/code.html">code</a></li>
                
                    <li ><a href="./category/linux.html">linux</a></li>
                
                    <li ><a href="./category/rand.html">rand</a></li>
                
                </ul></nav>
        </header><!-- /#banner -->
                

            

        
        
            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="./2012/11/20/tfa-google-auth/">Two-factor auth with Google Authenticator</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2012-11-20T00:00:00">
                Tue 20 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/serban-constantin.html">Serban Constantin</a>
        </address>
        
<p>In <a href="./category/linux.html">linux</a>. </p>
<p>tags: <a href="./tag/debian.html">Debian</a><a href="./tag/google.html">Google</a><a href="./tag/security.html">security</a><a href="./tag/tfa.html">TFA</a><a href="./tag/t-fa.html">T-FA</a><a href="./tag/2fa.html">2FA</a></p>


</footer><!-- /.post-info --><h2>The reason</h2>
<p>As you may remember I've went through <a href="static/2012/01/19/locked-out">a bit of an ordeal</a> trying to secure my server by allowing users to log in only with certificates. This had the advantage of being more secure than a password but, as time went on, the big disadvantage of not being able to log in from PCs which lacked the certs.</p>
<p>Moving forward (and doing a fresh install on the VPS, which I'll address in a future post) I've went back on my decision to only allow certificate based logins. The downside to this change is that I felt the the server was still exposed despite using a strong password.</p>
<p>Fortunately Google offers a nice Authenticator application for smartphones as well as offering a <a href="https://code.google.com/p/google-authenticator/">pluggable authentication module (PAM)</a> which ties in with the Authenticator app for two-factor authentication on login. This means that besides knowing the username and password someone would need to have a time-based one-time password generated by the app in order to log in to the site.</p>
<hr />
<h2>Installing google-authenticator PAM</h2>
<p>I'm running Debian so this guide applies to Debian and Debian-based distributions.</p>
<p>First of all we're going to need to install the build-essential package which will allow us to actually install the software.</p>
<p><code>sudo apt-get install build-essential</code></p>
<p>After we've got them installed we're going to install some dependencies needed for the PAM module to work (libpam-dev) as well as to retrieve (git) and easily configure the software (libqrencode-dev).</p>
<p><code>sudo apt-get install git libpam-dev libqrencode-dev libpam0g-dev</code></p>
<p>Now let's go ahead and download the code:</p>
<p><code>git clone https://code.google.com/p/google-authenticator/</code></p>
<p>This grabs the files from Google's server and creates a local copy. After that's done navigate to the google-authenticator/libpam directory and run</p>
<p><code>sudo make install</code></p>
<p>Now that we've got everything installed it's time to actually set up the application. This is extremely easy, just run <code>google-authenticator</code> which will generate a QR code (thanks to the libqrencode-dev package); scan this code in the Google Authenticator mobile app (or enter the information by hand) and head back to your PC to finish setting up the software by answering the questions it asks.</p>
<hr />
<h2>Setting up the OS to use Challenge Response Authentication</h2>
<p>Once the previous step is done we need to let the OS know that is has to use the newly installed PAM module. To do this we need to edit the <code>/etc/pam.d/common-auth</code> (by running <code>sudo vim /etc/pam.d/common-auth</code> for example) and adding the following line:</p>
<p><code>auth    required                        pam_google_authenticator.so</code></p>
<p>Next up is the ssh_config file in order to allow SSH to send challenge requests:</p>
<p><code>sudo vim /etc/ssh/sshd_config</code></p>
<p>Find the line containing <code>ChallengeResponseAuthentication</code> and set it to yes (also uncomment it if it's commented out) so that it looks like:</p>
<p><code>ChallengeResponseAuthentication yes</code></p>
<p>Now all there's left to do is restart the SSH server and to test the change:</p>
<p><code>sudo /etc/init.d/ssh restart</code></p>
<p>The next time you'll log in you should be greeted with a message asking for a verification code after entering the username and password.</p>
<div class="codehilite"><pre>ssh user@host
Password:
Verification code:
</pre></div>


<hr />
<h2>Bonus points</h2>
<p>One advantage to this is the fact that even if you log in using a certificate (which bypases the two-factor authentication) you are still asked for a verification code when trying to elevate to root via sudo for example.</p><p>There are <a href="./2012/11/20/tfa-google-auth/#disqus_thread">comments</a>.</p>
                </article>
                
            </aside><!-- /#featured -->
            
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
            
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./2012/11/19/git-revert-specific/" rel="bookmark"
                           title="Permalink to Git revert to commit">Git revert to commit</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-19T00:00:00">
                Mon 19 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/serban-constantin.html">Serban Constantin</a>
        </address>
        
<p>In <a href="./category/rand.html">rand</a>. </p>
<p>tags: <a href="./tag/git.html">git</a><a href="./tag/revert.html">revert</a><a href="./tag/undo.html">undo</a></p>


</footer><!-- /.post-info -->
                <p>Have you ever made a git commit only to figure out that it wasn't such a good idea? How about wanting to go back in your history and reverting to a specific commit? It's actually simple once you know how to do it:</p>
<div class="codehilite"><pre><span class="n">git</span> <span class="n">reset</span> 56<span class="n">e05fced</span>
<span class="n">git ...</span></pre></div>
                <a class="readmore" href="./2012/11/19/git-revert-specific/">read more</a>
                <p>There are <a href="./2012/11/19/git-revert-specific/#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./2012/09/08/quickcmd/" rel="bookmark"
                           title="Permalink to Quick command prompt to path">Quick command prompt to path</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-09-08T00:00:00">
                Sat 08 September 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/serban-constantin.html">Serban Constantin</a>
        </address>
        
<p>In <a href="./category/rand.html">rand</a>. </p>
<p>tags: <a href="./tag/windows.html">Windows</a><a href="./tag/cmd.html">cmd</a><a href="./tag/tips.html">tips</a></p>


</footer><!-- /.post-info -->
                <p>If you're working a lot with the command prompt and Windows Explorer you find yourself either having to copy/paste a lot of paths into cmd.exe or just wasting time writing them by hand. Windows 8 addresses that with a (more visible) open command prompt here button, but ...</p>
                <a class="readmore" href="./2012/09/08/quickcmd/">read more</a>
                <p>There are <a href="./2012/09/08/quickcmd/#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./2012/06/13/prometheus/" rel="bookmark"
                           title="Permalink to Let there be Prometheus">Let there be Prometheus</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-06-13T00:00:00">
                Wed 13 June 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/serban-constantin.html">Serban Constantin</a>
        </address>
        
<p>In <a href="./category/rand.html">rand</a>. </p>
<p>tags: <a href="./tag/prometheus.html">Prometheus</a><a href="./tag/movies.html">movies</a></p>


</footer><!-- /.post-info -->
                <p>I thought the movie was good, great even if you haven't watched any of the trailers. Michael Fassbender played a perfect evil android, from the stiff posture to the robotic reactions to things around him. I wasn't exactly sold on Noomi's character but she did a great ...</p>
                <a class="readmore" href="./2012/06/13/prometheus/">read more</a>
                <p>There are <a href="./2012/06/13/prometheus/#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./2012/06/08/extract-archive-recursively/" rel="bookmark"
                           title="Permalink to Enhanc... erm, extract!">Enhanc... erm, extract!</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-06-08T00:00:00">
                Fri 08 June 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/serban-constantin.html">Serban Constantin</a>
        </address>
        
<p>In <a href="./category/code.html">code</a>. </p>
<p>tags: <a href="./tag/7-zip.html">7-zip</a><a href="./tag/recursive.html">recursive</a><a href="./tag/archives.html">archives</a><a href="./tag/bat.html">bat</a></p>


</footer><!-- /.post-info -->
                <p>We've all been there, haven't we? We just downloaded the latest seaso... erm, Linux distro and it came with lots of folders which in turn contain lots of archives, one folder per episode. One way to do things is to just extract each episode... erm, distro, by hand ...</p>
                <a class="readmore" href="./2012/06/08/extract-archive-recursively/">read more</a>
                <p>There are <a href="./2012/06/08/extract-archive-recursively/#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            </ol><!-- /#posts-list -->
            
                
<p class="paginator">
    
    Page 1 / 5
    
        <a href="./index2.html">&raquo;</a>
    
</p>

            
            </section><!-- /#content -->
        
    


        <section id="extras" class="body">
        
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-28459915-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



<script type="text/javascript">
    var disqus_shortname = 'qwertyfuzz';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</body>
</html>